{% extends 'base.html.twig' %}

{% block title %}Lista de Productos{% endblock %}

{% block body %}
<style>
    .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
    .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
</style>

<div class="example-wrapper">
    <h1>Lista de Productos</h1>
    <a href="{{ path('product_new') }}">Agregar</a>
    {% for label, messages in app.flashes %}
        {% for message in messages %}
            <div class="alert alert-success" role="alert">
                {{ message }}
            </div>
        {% endfor %}
    {% endfor %}
    <table class="table">
        <thead class="thead-dark">
        <tr>
            <th scope="col">Nombre</th>
            <th scope="col">Descripción</th>
            <th scope="col">Código</th>
            <th scope="col">Categoría</th>
            <th scope="col">Precio</th>
            <th scope="col">acción</th>
        </tr>
        </thead>
        <tbody>
        {% for product in products %}
            <tr>
                <th scope="row">{{product.name}}</th>
                <td>{{product.description}}</td>
                <td>{{product.code}}</td>
                <td>{{ product.category.name }}</td>
                <td>{{ product.price }}</td>
                <td>
                    {% if product.category.active %}
                    <a href="{{ path('product_edit',{id:product.id}) }}">Editar</a>
                    {% endif %}
                    <a href="{{ path('product_remove',{id:product.id}) }}" class="destroy_product">Eliminar</a>
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
{% block javascripts %}
    {{ parent() }}
    <script>
        $(function () {
            $('.destroy_product').click(function (e) {
                e.preventDefault();
                Swal.fire({
                    title: 'Realmente Deseas Eliminar Este Elemento',
                    text: "No podras revertir esta Acción!",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Yes, delete it!'
                }).then((result) => {
                    if (result.value) {
                        $(location).attr('href', $(this).attr('href'))
                    }
                })
            });
        });
    </script>
{% endblock %}
